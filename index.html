<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BookBunny ğŸ“šğŸ°</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<button id="logoutBtn" class="logout">Logout</button>
<button id="themeToggle" class="theme-btn">ğŸŒ™</button>

<div class="container">
  <h1 id="welcomeTitle">Welcome to BookBunny ğŸ°</h1>
  <p>Your cozy corner for book lovers ğŸ’•</p>

  <button id="loadBooks" class="main-btn">Show Recommended Books âœ¨</button>
  <ul id="bookList"></ul>
</div>

<script>
console.log("âœ… Home script loaded");

const apiUrl = "https://bookbunny-backend.onrender.com";

// âœ… Personalized greeting
const user = localStorage.getItem("username");
if (!user) {
  window.location.href = "login.html";
} else {
  document.getElementById("welcomeTitle").textContent = `Hi ${user} ğŸ°`;
}

// âœ… Recommended Books - correct route âœ…
document.getElementById("loadBooks").addEventListener("click", async () => {
  console.log("ğŸ“Œ Recommended button clicked");

  const res = await fetch(`${apiUrl}/books`);
  const books = await res.json();

  console.log("ğŸ“š Books:", books);

  const list = document.getElementById("bookList");
  list.innerHTML = "";

  books.forEach(book => {
    const item = document.createElement("li");
    item.classList.add("book-card");
    item.innerHTML = `
      <h3>${book.title}</h3>
      <p><strong>Author:</strong> ${book.author}</p>
      <p><strong>Genre:</strong> ${book.genre}</p>
    `;
    list.appendChild(item);
  });
});

// âœ… Logout
document.getElementById("logoutBtn").addEventListener("click", () => {
  localStorage.removeItem("username");
  window.location.href = "login.html";
});

// âœ… Theme toggle + saved preference
const btnTheme = document.getElementById("themeToggle");
if(localStorage.getItem("theme") === "dark"){
  document.body.classList.add("dark");
  btnTheme.textContent = "â˜€ï¸";
}
btnTheme.addEventListener("click", ()=>{
  const dark = document.body.classList.toggle("dark");
  btnTheme.textContent = dark ? "â˜€ï¸" : "ğŸŒ™";
  localStorage.setItem("theme", dark ? "dark" : "light");
});
</script>

</body>
</html>
